{% extends "dashboard_base.html" %}

{% block title %}仪表盘{% endblock %}
{% block page_title %}仪表盘概览{% endblock %}

{% block content %}
<div class="row g-4">
    <!-- 统计卡片 -->
    <div class="col-xl-3 col-md-6">
        <div class="stats-card">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <p class="stats-label">总账号数</p>
                    <h3 class="stats-number">{{ stats.total_accounts or 0 }}</h3>
                </div>
                <div class="text-primary">
                    <i class="fas fa-users fa-2x"></i>
                </div>
            </div>
            <small class="text-muted">
                <i class="fas fa-check-circle text-success"></i>
                活跃账号: {{ stats.active_accounts or 0 }}
            </small>
        </div>
    </div>
    
    <div class="col-xl-3 col-md-6">
        <div class="stats-card">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <p class="stats-label">总卡密数</p>
                    <h3 class="stats-number">{{ stats.total_cards or 0 }}</h3>
                </div>
                <div class="text-primary">
                    <i class="fas fa-credit-card fa-2x"></i>
                </div>
            </div>
            <small class="text-muted">
                <i class="fas fa-eye text-info"></i>
                已使用: {{ stats.used_cards or 0 }} | 
                <i class="fas fa-eye-slash text-warning"></i>
                未使用: {{ stats.unused_cards or 0 }}
            </small>
        </div>
    </div>
    
    <div class="col-xl-3 col-md-6">
        <div class="stats-card">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <p class="stats-label">近7天新增</p>
                    <h3 class="stats-number">{{ stats.recent_accounts or 0 }}</h3>
                </div>
                <div class="text-primary">
                    <i class="fas fa-user-plus fa-2x"></i>
                </div>
            </div>
            <small class="text-muted">
                <i class="fas fa-plus-circle text-success"></i>
                新增账号数量
            </small>
        </div>
    </div>
    
    <div class="col-xl-3 col-md-6">
        <div class="stats-card">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <p class="stats-label">即将到期</p>
                    <h3 class="stats-number text-warning">{{ stats.expiring_accounts or 0 }}</h3>
                </div>
                <div class="text-warning">
                    <i class="fas fa-exclamation-triangle fa-2x"></i>
                </div>
            </div>
            <small class="text-muted">
                <i class="fas fa-clock text-warning"></i>
                7天内到期的VIP账号
            </small>
        </div>
    </div>
</div>

<!-- 快速操作 -->
<div class="row g-4 mt-4">
    <div class="col-12">
        <div class="content-card">
            <div class="content-header">
                <h5><i class="fas fa-bolt text-primary"></i> 快速操作</h5>
            </div>
            <div class="content-body">
                <div class="row g-3">
                    <div class="col-lg-3 col-md-6">
                        <a href="{{ url_for('accounts') }}" class="btn btn-primary w-100 py-3">
                            <i class="fas fa-users fa-lg mb-2 d-block"></i>
                            账号管理
                        </a>
                    </div>
                    <div class="col-lg-3 col-md-6">
                        <a href="{{ url_for('cards') }}" class="btn btn-outline-primary w-100 py-3">
                            <i class="fas fa-credit-card fa-lg mb-2 d-block"></i>
                            卡密管理
                        </a>
                    </div>
                    <div class="col-lg-3 col-md-6">
                        <a href="{{ url_for('batch_generate') }}" class="btn btn-outline-primary w-100 py-3">
                            <i class="fas fa-layer-group fa-lg mb-2 d-block"></i>
                            批量生成
                        </a>
                    </div>
                    <div class="col-lg-3 col-md-6">
                        <a href="{{ url_for('manage_notice') }}" class="btn btn-outline-primary w-100 py-3">
                            <i class="fas fa-bullhorn fa-lg mb-2 d-block"></i>
                            公告管理
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 系统信息 -->
<div class="row g-4 mt-4">
    <div class="col-lg-8">
        <div class="content-card">
            <div class="content-header">
                <h5><i class="fas fa-chart-line text-primary"></i> 系统概览</h5>
            </div>
            <div class="content-body">
                <div class="row g-4">
                    <div class="col-md-6">
                        <div class="border rounded p-3">
                            <h6 class="text-primary mb-3">
                                <i class="fas fa-users"></i> 账号统计
                            </h6>
                            <div class="d-flex justify-content-between mb-2">
                                <span>总账号数:</span>
                                <strong>{{ stats.total_accounts or 0 }}</strong>
                            </div>
                            <div class="d-flex justify-content-between mb-2">
                                <span>活跃账号:</span>
                                <strong class="text-success">{{ stats.active_accounts or 0 }}</strong>
                            </div>
                            <div class="d-flex justify-content-between">
                                <span>近7天新增:</span>
                                <strong class="text-info">{{ stats.recent_accounts or 0 }}</strong>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="border rounded p-3">
                            <h6 class="text-primary mb-3">
                                <i class="fas fa-credit-card"></i> 卡密统计
                            </h6>
                            <div class="d-flex justify-content-between mb-2">
                                <span>总卡密数:</span>
                                <strong>{{ stats.total_cards or 0 }}</strong>
                            </div>
                            <div class="d-flex justify-content-between mb-2">
                                <span>已使用:</span>
                                <strong class="text-info">{{ stats.used_cards or 0 }}</strong>
                            </div>
                            <div class="d-flex justify-content-between">
                                <span>未使用:</span>
                                <strong class="text-warning">{{ stats.unused_cards or 0 }}</strong>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-lg-4">
        <div class="content-card">
            <div class="content-header">
                <h5><i class="fas fa-info-circle text-primary"></i> 系统信息</h5>
            </div>
            <div class="content-body">
                <div class="mb-3">
                    <small class="text-muted">系统版本</small>
                    <div class="fw-bold">卡密查询系统 v2.2</div>
                </div>
                <div class="mb-3">
                    <small class="text-muted">数据库类型</small>
                    <div class="fw-bold">SQLite</div>
                </div>
                <div class="mb-3">
                    <small class="text-muted">当前时间</small>
                    <div class="fw-bold" id="currentTime"></div>
                </div>
                <div>
                    <small class="text-muted">在线状态</small>
                    <div class="fw-bold text-success">
                        <i class="fas fa-circle"></i> 正常运行
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // 更新当前时间
    function updateTime() {
        const now = new Date();
        const timeString = now.toLocaleString('zh-CN', {
            year: 'numeric',
            month: '2-digit',
            day: '2-digit',
            hour: '2-digit',
            minute: '2-digit',
            second: '2-digit'
        });
        document.getElementById('currentTime').textContent = timeString;
    }
    
    // 每秒更新时间
    setInterval(updateTime, 1000);
    updateTime(); // 立即更新一次
    
    // 页面加载完成后的动画效果
    document.addEventListener('DOMContentLoaded', function() {
        const cards = document.querySelectorAll('.stats-card');
        cards.forEach((card, index) => {
            setTimeout(() => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                card.style.transition = 'all 0.5s ease';
                
                setTimeout(() => {
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, 100);
            }, index * 100);
        });
    });
</script>
{% endblock %}
